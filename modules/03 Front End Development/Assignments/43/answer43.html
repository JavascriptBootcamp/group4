<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body onload="startGame()">
    <h2>choose difficulty level</h2>
    <select id="level">
        <option>easy</option>
        <option>medium</option>
        <option>hard</option>
    </select>
    <select id="values">
    </select>
    <!-- <button onclick="startGame()">Start Game</button> -->
    <div id="result"></div>
    <script>
        var randomWord;
        var values;
        var counter;
        var level = document.getElementById("level").options.selectedIndex;
        var win;
        function startGame() {
            initialGame();
            createLetters();
            createEvents();
            console.log(randomWord);
        }
        function createEvents() {
            values.onchange = onLetterClick;
        }
        function onLetterClick(e) {
            var newLevel = document.getElementById("level");
            var selected = e.target.selectedIndex;
            if (counter < randomWord.length && checkLetter(selected)) {
                showLetter(selected);
            }
            else{
                newLevel.selectedIndex = 0;
            }
            if (win) {
                checkWin();
            }
            else {
                level = 0;
            }

        }
        function checkWin() {
            var newLevel = document.getElementById("level");
            if (counter === randomWord.length) {
                result.innerText = "you win";
                newLevel.selectedIndex = level;
                setTimeout(function () {
                    startGame();
                }, 2000);
            }
        }
        function showLetter(selected) {
            var letter = values[selected].innerText;
            result.innerText += letter;
        }
        function checkLetter(selected) {
            var letter = values[selected].innerText;
            if (letter === randomWord[counter]) {
                counter++;
                win = true;
                return true;
            }
            else {
                setTimeout(function () {
                    startGame();
                }, 2000);
                result.innerText = "you lose";
                values.disabled = true;
                counter = 0;
                win = false;
                return false;
            }
        }
        function createLetters() {
            var arr = [];
            var option;
            arr = randomWord.split("");
            values.innerHTML = "";
            option = document.createElement("option");
            option.innerText = "";
            values.appendChild(option);
            arr = arr.sort();
            arr.forEach(element => {
                option = document.createElement("option");
                option.innerText = element;
                values.appendChild(option);
            });
        }
        function initialGame() {
            var word1 = new RandomWord(['a', 'k', 'r']);
            var word2 = new RandomWord(['a', 'b', 'c', 't', 'z']);
            var word3 = new RandomWord(['a', 'b', 'c', 'd', 'e', 'f', 'g']);
            counter = 0;
            win = false;
            result = document.getElementById("result");
            values = document.getElementById("values");
            values.disabled = false;
            result.innerText = "";
            if (level === 0) {
                level++;
                randomWord = word1.randomize(3)
            }
            else if (level === 1) {
                level++;
                randomWord = word2.randomize(5)
            }
            else if (level === 2) {
                level = 0;
                randomWord = word3.randomize(7)
            }
        }
        function RandomWord(charsArray) {
            if (typeof charsArray === 'object') {
                //this.result = randomize(charsArray); 
            }
            else {
                console.log('"chars" should be an array.');
            }
            this.randomize = function (length) {
                if (typeof length === 'number') {
                    var text = "";
                    var possible = charsArray.join("");
                    for (var i = 0; i < length; i++)
                        text += possible.charAt(Math.floor(Math.random() * possible.length));
                    return text;
                }
                else {
                    console.log('"length" should be a number.');
                }
            }
        }
    </script>
</body>

</html>