<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <div>
        <input onclick="setDifficultyLevel(this.id,this.value)" type="radio" id="easy" value="3" name="difL" checked><lable for="easy">Easy</lable>
        <input onclick="setDifficultyLevel(this.id,this.value)" type="radio" id="medium" value="5" name="difL"><lable for="medium">Medium</lable>
        <input onclick="setDifficultyLevel(this.id,this.value)" type="radio" id="hard" value="7" name="difL"><lable for="hard">Hard</lable>
    </div>
    <button onclick="startGame()">Start New Game</button>
    <table border="1">
        <tr id="board">
        </tr>
    </table>
    <div id="insert"></div>

    <script>
    var level = 'easy';
    var amountOfChars = 3;
    var counter = 0;
    var generatedWord = "";
    function setDifficultyLevel(diffecultyLevel,charsCount){
        level = diffecultyLevel;
        amountOfChars = charsCount;
    }
    function gameReset(){
        generatedWord = "";
        counter=0;
        var board = document.getElementById("board");
            while (board.firstChild) {
                board.removeChild(board.firstChild);
            }
        var insertDiv = document.getElementById("insert");
        while (insertDiv.firstChild) {
            insertDiv.removeChild(insertDiv.firstChild);
        }
    }
    function createTable(){
        for(var i=0;i<amountOfChars;i++)
            {
                var td = document.createElement("td");
                td.style.height="60px";
                td.style.width="60px";
                document.getElementById("board").appendChild(td);
            }
    }
    function createLettersList(word){
        var arrWord = word.split("");
        var select = document.createElement("select");
        select.id="letterList"
        arrWord.sort();
        for(var i=0;i<arrWord.length;i++){
            var option = document.createElement("option");
            option.value=arrWord[i];
            option.innerText=arrWord[i];
            option.id="option"+i;
            select.appendChild(option);
        }
        document.getElementById("insert").appendChild(select);
    }
    function randomizeWords(lengthOfWord){
        var abc = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];
        var randomWord = "";
        for(var i=0;i<lengthOfWord;i++)
        {
            randomWord += abc[Math.floor(Math.random() * abc.length)];
        }
        generatedWord = randomWord;
        return randomWord;
    }
    function createButton(){
        var btn = document.createElement("button");
        btn.id = "insertButton";
        btn.innerText="Insert";
        btn.setAttribute("onclick","insertLetter()");
        document.getElementById("insert").appendChild(btn);
    }
    function insertLetter(){
        // var options = document.getElementsByTagName("option");
        var tds = document.getElementsByTagName("td");
        var letterList = document.getElementById("letterList");
        var index = letterList.selectedIndex;
        tds[counter].innerText = letterList.childNodes[index].value;
        letterList.removeChild(letterList.childNodes[index]);
        letterList.selectedIndex=0;
        counter++;
        if(!(tds[amountOfChars-1].innerText===""))
        {
            removeListandButton(letterList);
            createCheckWinButton();
        }
    }
    function createCheckWinButton(){
        var newBtn =  document.createElement("button");
        newBtn.id = "checkWinButton";
        newBtn.innerText="Check Answer";
        newBtn.setAttribute("onclick","checkWin()");
        document.getElementById("insert").appendChild(newBtn);
    }
    function removeListandButton(letterList){
        letterList.parentNode.removeChild(letterList);
        var btn = document.getElementById ("insertButton");
        btn.parentNode.removeChild(btn);
    }
    function checkWin(){
        var answer = "";
        var tds = document.getElementsByTagName("td");
        var message = document.createElement("h2");
        var domParent = document.getElementById("insert");
        var levelButtons = document.getElementsByName("difL");
        for(var i =0;i<amountOfChars;i++){
            answer += tds[i].innerText;
            if(tds[i].innerText===generatedWord[i])
                tds[i].style.backgroundColor = 'green';
            else
                tds[i].style.backgroundColor = 'red';
        }
        console.log(answer);
        console.log(generatedWord);
        if(answer===generatedWord)
        {
            message.innerText = "You won";

            // domParent.appendChild(message);
            domParent.replaceChild(message,domParent.firstChild)
            for(var i=0;i<3;i++)
                levelButtons[i].disabled = false;
            nextLevel();
        }
        else
        {
            message.innerText = "You Lost";
            // domParent.appendChild(message);
            domParent.replaceChild(message,domParent.firstChild)
            for(var i=0;i<3;i++)
                levelButtons[i].disabled = false;
        }
    }
    function nextLevel(){
        if(amountOfChars===3){
            setTimeout(() => {
                setDifficultyLevel("medium",5)
                document.getElementById("medium").checked=true;
                startGame();
            }, 900);
        }
        else if(amountOfChars===5){
            setTimeout(() => {
                setDifficultyLevel("high",7)
                document.getElementById("high").checked=true;
                startGame();
            }, 900)
        }
        else{
            console.log("no more levels")
        }
    
    }
    function startGame(){
            var levelButtons = document.getElementsByName("difL");
            for(var i=0;i<3;i++){
                levelButtons[i].disabled = true;
            }
            gameReset();
            createTable();
            createLettersList(randomizeWords(amountOfChars));
            createButton();
    }
    </script>
</body>
</html>

