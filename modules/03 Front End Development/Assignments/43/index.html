<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Random Word</title>
</head>

<body>
    <select name="levels" id="levels">
        <option value='easy'>Easy</option>
        <option value='medium'>Medium</option>
        <option value='hard'>Hard</option>
    </select>
    <button id='start' onclick='play()'>Start Game</button>
    <div id='guessTheWord'>

    </div>
    <div id='choose' style='margin-top:5px;'>

    </div>
    <div id='msg' style='margin-top:5px;'>

    </div>
    <script>
        function RandomWord(charsArray) {
            if (typeof charsArray === 'object') {
                //this.result = randomize(charsArray); 
            }
            else {
                console.log('"chars" should be an array.');
            }
            this.randomize = function (length) {
                if (typeof length === 'number') {
                    var text = "";
                    var possible = charsArray.join("");
                    for (var i = 0; i < length; i++)
                        text += possible.charAt(Math.floor(Math.random() * possible.length));
                    return text;
                }
                else {
                    console.log('"length" should be a number.');
                }
            }
        }

        function play() {
            var levels = document.getElementById('levels');
            var btn = document.getElementById('start');
            var div = document.getElementById('guessTheWord');
            var divChoose = document.getElementById('choose');
            var message = document.getElementById('msg');
            btn.disabled = true;
            levels.disabled = true;
            var arr;
            var num;
            if (levels.selectedIndex == 0) {
                num = 3;
            } else if (levels.selectedIndex == 1) {
                num = 5;
            } else {
                num = 7;
            }
            arr = randomLetters(num);
            console.log(arr);
            var correctWord = new RandomWord(arr);
            var word = correctWord.randomize(num);
            arr = sortLetters(word);
            console.log(arr);
            console.log('the word is:' + word);
            var txt = '';
            var selectLetters = document.createElement('select');
            selectLetters.setAttribute('id', 'selectLetters');
            selectLetters.onchange = guess;
            var opt;
            opt = document.createElement('option');
            opt.value = 'instruction';
            opt.innerText = 'choose letter one by one';
            selectLetters.appendChild(opt);
            for (var i = 0; i < num; i++) {
                txt += '_ ';
                opt = document.createElement('option');
                opt.value = arr[i];
                opt.innerText = arr[i];
                selectLetters.appendChild(opt);
            }
            div.innerText = txt;
            divChoose.appendChild(selectLetters);
            var count = 0;
            function guess() {
                if (selectLetters.options[selectLetters.selectedIndex].value === word[count]) {
                    var str = div.innerText.substring(0, count) + word[count];
                    console.log(str);
                    txt = '';
                    for (var i = count + 1; i < num; i++) {
                        txt += '_ ';
                    }
                    str += txt;
                    div.innerText = str;
                    deleteOption(selectLetters.selectedIndex);
                    if (count + 1 === word.length) {
                        message.innerText = 'Nice! You guessed the word.';
                        if (num === 7) {
                            message.innerText += ' Game Over.';
                            setTimeout(() => {
                                resetDivs();
                                levels.disabled = false;
                                btn.disabled = false;
                            }, 1500);
                        } else {
                            setTimeout(() => {
                                resetDivs();
                                levels.selectedIndex = levels.selectedIndex + 1;
                                play();
                            }, 1500);
                        }
                    }
                } else if (selectLetters.selectedIndex !== 0) {
                    resetDivs();
                    play();
                }
                count++;

            }

            function resetDivs() {
                div.innerText = '';
                divChoose.removeChild(selectLetters);
                message.innerText = '';

            }
            function randomLetters(length) {// to choose 3/5/7 unique letters
                var randomLettersArr = [];
                var abc = 'abcdefghijklmnopqrstuvwxyz';
                abc = abc.split('');
                for (var i = 0; i < length; i++) {
                    randomLettersArr.push(abc.splice(Math.floor(Math.random() * (26 - i)), 1)[0]);
                }
                randomLettersArr.sort();
                return randomLettersArr;
            }

            function sortLetters(str) {
                var letters = str.split('');
                letters.sort();
                return letters;
            }

            function deleteOption(k) {
                selectLetters.removeChild(selectLetters.options[k]);
            }
        }
    </script>
</body>

</html>