<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <style>
        /* * {
             visibility: hidden; 
        }  */

        .rounded {
            height: 100px;
            width: 100px;
            position: absolute;
            border-radius: 50%;
            border: 1px solid red;
        }

        div.center {
            width: 30%;
            margin-left: 35%;
            margin-right: 35%;
        }


        .line {
            position: relative;
            height: 100px;
            width: 308px;
        }

        .second {
            left: 100px;
        }

        .third {
            left: 200px;
        }

        .visibility {
            visibility: visible;
        }
    </style>

</head>

<body>
    <form onsubmit="return false">
        <label for="pl1" class="visibility">Player 1 (X)</label>
        <input type="text" class="visibility" id="pl1"><br>



        <label for="pl2" class="visibility">Player 2 (O)</label>
        <input type="text" class="visibility" id="pl2"><br>

        <input type="submit" value="Start Game" name="submit" onclick="start()"><br>
        
        <div id="di"></div><br>

        <div class="center visibility">
            <div class="line">
                <input type="button" class="rounded" name="0 0" onclick="selectXorO(`0 0`)">
                <input type="button" class="rounded second" name="1 0" onclick="selectXorO(`1 0`)">
                <input type="button" class="rounded third" name="2 0" onclick="selectXorO(`2 0`)">
            </div>

            <div class="line">

                <input type="button" class="rounded" name="0 1" onclick="selectXorO(`0 1`)">
                <input type="button" class="rounded second" name="1 1" onclick="selectXorO(`1 1`)">
                <input type="button" class="rounded third" name="2 1" onclick="selectXorO(`2 1`)">

            </div>

            <div class="line">

                <input type="button" class="rounded" name="0 2" onclick="selectXorO(`0 2`)">
                <input type="button" class="rounded second" name="1 2" onclick="selectXorO(`1 2`)">
                <input type="button" class="rounded third" name="2 2" onclick="selectXorO(`2 2`)">

            </div>
        </div>
        <button onclick="light()">Light</button>
        <button onclick="dark()">Dark</button>


    </form>

    <script>

        var turn;
        var board = [];
        var fin = null;
        var d;

        function light() {
            document.body.style.backgroundColor = "#FEF0C1";
        }

        function dark() {
            document.body.style.backgroundColor = "#5A142A";
        }

        function display () {
            var matches = document.querySelectorAll(".visibility");
            for (var iterator of matches) {
                    iterator.style.visibility = "visible";
                }
        }

        function hide () {
            var matches = document.querySelectorAll(".visibility");
                for (var iterator of matches) {
                    iterator.style.visibility = "hidden";
                }
        }

        function clearAll() {
            board = [];
            var matches = document.querySelectorAll(".rounded");
            for (var iterator of matches) {
                    iterator.value = "";
                }
        }


        function start() {
            // if the player press 'start game' button after the game is finished.
            if (fin === 1 || fin === 2) {
                board = [];
                fin = null;
                hide();
                clearAll();
            }

            display();
            turn = 1;
            d = document.getElementById("di");
            d.innerText = document.getElementById("pl1").value + " is your turn";


            board = new Array(3);
            for (var i = 0; i < board.length; i++) {
                board[i] = new Array(3);
            }
            for (var i = 0; i < board.length; i++) {
                board[i].fill(null);
            }
        }


        function selectXorO(str) {

            var x_y = str.split(" ");
            var x = x_y[0];
            var y = x_y[1];



            if (turn === 1) {       // player 1's turn

                document.getElementsByName(str)[0].value = "X";

                board[x][y] = true;  // true is for player 1
                // turn goes to the other playerd.
                d.innerText = document.getElementById("pl2").value + " is your turn";
                turn = 2;
            } else {                // player 2's turn

                document.getElementsByName(str)[0].value = "O";
                // turn goes to the other playerd.
                d.innerText = document.getElementById("pl1").value + " is your turn";
                board[x][y] = false; // false is for player 2
                turn = 1;
            }

            fin = check_win(); // 1 if player 1 wins, 2 if player 2 wins and 0 if game needs to contuniue  
            if (fin === 1) {
                d.innerText = document.getElementById("pl1").value + " WIN!!!!";
                hide();
            } else if (fin === 2) {
                d.innerText = document.getElementById("pl2").value + " WIN!!!!";
                hide();
            }

        }

        function check_win() {

            var x, y;
            var row_win_pl1 = true;
            var col_win_pl1 = true;
            var diag_win_pl1 = true;
            var cross_win_pl1 = true;

            var row_win_pl2 = true;
            var col_win_pl2 = true;
            var diag_win_pl2 = true;
            var cross_win_pl2 = true;


            for (x = 0; x < board.length; x++) {
                for (y = 0; y < board.length; y++) {
                    // row for player 1
                    if (row_win_pl1 && board[x][y] === true) {
                        row_win_pl1 = true;
                    }
                    else {
                        row_win_pl1 = false;
                    }

                    // row for player 2
                    if (row_win_pl2 && board[x][y] === false) {
                        row_win_pl2 = true;
                    }
                    else {
                        row_win_pl2 = false;
                    }

                    // coloum

                    // col for player 1
                    if (col_win_pl1 && board[y][x] === true) {
                        col_win_pl1 = true;
                    }
                    else {
                        col_win_pl1 = false;
                    }

                    // col for player 2
                    if (col_win_pl2 && board[y][x] === false) {
                        col_win_pl2 = true;
                    }
                    else {
                        col_win_pl2 = false;
                    }

                }

                // diagonal


                if (diag_win_pl1 && board[x][x] === true) {
                    diag_win_pl1 = true;
                }
                else {
                    diag_win_pl1 = false;
                }

                // row for player 2
                if (diag_win_pl2 && board[x][x] === false) {
                    diag_win_pl2 = true;
                }
                else {
                    diag_win_pl2 = false;
                }


                // cross


                if (cross_win_pl1 && board[board.length - x - 1][x] === true) {
                    cross_win_pl1 = true;
                }
                else {
                    cross_win_pl1 = false;
                }

                // row for player 2
                if (cross_win_pl2 && board[board.length - x - 1][x] === false) {
                    cross_win_pl2 = true;
                }
                else {
                    cross_win_pl2 = false;
                }



                if (row_win_pl1 || col_win_pl1) {
                    return 1;
                } else {
                    if (row_win_pl2 || col_win_pl2) {
                        return 2;
                    }
                }

                row_win_pl1 = true;
                col_win_pl1 = true;

                row_win_pl2 = true;
                col_win_pl2 = true;


            }

            if (diag_win_pl1 || cross_win_pl1) {
                return 1;
            } else {
                if (diag_win_pl2 || cross_win_pl2) {
                    return 2;
                } else {
                    return 0;
                }
            }
        }

    </script>
</body>

</html>
